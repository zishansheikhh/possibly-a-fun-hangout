<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>A Totally Scientific Survey - No Strings Attached</title>
  <script type="text/javascript"
        src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js">
</script>
  <script>
    (function() {
        emailjs.init("x3PA0gDR68jqAzf2h");  
    })();
  </script>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: url("sky.png") no-repeat center center fixed;
      background-size: cover;
      backdrop-filter: blur(2px);
      color: #333;
      height: 100vh;
      width: 100%;
      margin: auto;
      overflow: hidden;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    body.popup-active .container {
      filter: blur(4px);
      pointer-events: none;
    }

    .container {
      max-width: 700px;
      background: rgb(255, 254, 253);
      width: 290px;
      padding: 1.2rem;
      border-radius: 20px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
      position: relative;
    }

    h1 {
      text-align: center;
      color: #6a1b9a;
      font-size: 1.5rem;
    }

    .question {
      display: none;
      opacity: 0;
      transform: scale(0.95);
      transition: all 0.4s ease-in-out;
    }

    .question.active {
      display: block;
      opacity: 1;
      transform: scale(1);
    }


    label {
      display: block;
      margin: 0.5rem 0;
      cursor: pointer;
    }

    select {
      margin-top: 0.5rem;
      padding: 0.4rem;
      border-radius: 5px;
      border: 1px solid #ccc;
    }

    .end-message {
      display: none;
      padding: 2rem;
      background: #fff3e0;
      border-left: 5px solid #43a047;
      border-radius: 12px;
      font-size: 1.2rem;
      text-align: center;
      color: #2e7d32;
    }

    button {
      margin-top: 1rem;
      background-color: #6a1b9a;
      color: white;
      border: none;
      padding: 0.6rem 1.4rem;
      font-size: 0.9rem;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.3s;
    }

    button:hover {
      background-color: #8e24aa;
    }

    .popup-image {
      width: 100%;
      border-radius: 12px;
      margin-top: 1rem;
    }
  </style>
</head>
<body>
<div class="container">
  <h1>A Totally Scientific Survey - No Strings Attached</h1>
  <form id="dateForm">
    <div class="question active" id="q1">
      <p>1. Do you like cats?</p>
      <label><input type="radio" name="cats" value="yes"> Yes</label>
      <label><input type="radio" name="cats" value="no"> No</label>
    </div>

    <div class="question" id="q2"> 
        <p>2. Would you like to spend time with a cat person?</p>
        <label><input type="radio" name="cat_person" value="yes"> Yes</label>
        <label><input type="radio" name="cat_person" value="no"> No</label> 
    </div>

    <div class="question" id="q2a">
        <p>3. What's your ideal kind of hangout?</p>
        <label><input type="radio" name="date_type" value="Coffee & Chat"> Coffee/Chat & Baatcheet</label>
        <label><input type="radio" name="date_type" value="Long Walks"> Long Walks</label>
        <label><input type="radio" name="date_type" value="Movie & Chill"> Street Food Hunt</label>
        <label><input type="radio" name="date_type" value="Adventure Surprise"> All of the above</label>
    </div>

    <div class="question" id="q2b">
        <p>4. How long do you like hanging out on first meets?</p>
        <label><input type="radio" name="duration" value="Quick 30 mins"> Quick 30 mins</label>
        <label><input type="radio" name="duration" value="1-2 hours"> 1‚Äì2 hours</label>
        <label><input type="radio" name="duration" value="3+ hours"> 3+ hours</label>
        <label><input type="radio" name="duration" value="Until they kick us out"> Until they kick us out</label>
    </div>

    <div class="question" id="q2c">
        <p>5. Choose the vibe for the day:</p>
        <label><input type="radio" name="vibe" value="Chill & Cozy"> Chill & Cozy</label>
        <label><input type="radio" name="vibe" value="Silly & Fun"> Silly & Fun</label>
        <label><input type="radio" name="vibe" value="Deep Talk Energy"> Deep Talk Energy</label>
        <label><input type="radio" name="vibe" value="Flirty Chaos"> Flirty Chaos</label>
    </div>


    <div class="question" id="q3"> 
        <p>3. Please select a city you‚Äôre in or want to go to:</p>    
        <label><input type="radio" name="city" value="Indore"> Indore</label>
        <label><input type="radio" name="city" value="Jaipur"> Jaipur</label>
        <label><input type="radio" name="city" value="Delhi"> Delhi</label>
        <label><input type="radio" name="city" value="Lucknow"> Lucknow</label>
    </div>

    <div class="question" id="q4"> 
        <p>4. Select a month:</p>   
        <select name="month">
            <option>June</option>
            <option>July</option>
            <option>August</option>
            <option>September</option>
            <option>October</option>
        </select>
        <br><br> 
        <button type="button" id="monthNext">Next</button>
    </div>

    <div class="question" id="q5">
      <p>5. On a scale from 1-5, how much did you enjoy this survey?</p>
      <small>(1 = Creeped out, 5 = Bursting out of laughter)</small><br>
      <label><input type="radio" name="rating" value="1"> 1</label>
      <label><input type="radio" name="rating" value="2"> 2</label>
      <label><input type="radio" name="rating" value="3"> 3</label>
      <label><input type="radio" name="rating" value="4"> 4</label>
      <label><input type="radio" name="rating" value="5"> 5</label>
    </div>

    <div class="question" id="q6"> 
        <p>6. Accept the invitation?</p> 
        <label><input type="radio" name="accept" value="yes"> Yes</label>
        <label><input type="radio" name="accept" value="no"> No</label>  
        <button type="submit">Finish</button> 
    </div>

    <div class="question" id="q7">
    <p>7. Final step! Drop your email and phone number</p>
    <label>
        Email (required):<br>
        <input type="email" name="email" required style="width: 100%; padding: 0.5rem; margin-top: 0.5rem;" />
    </label><br><br>
    <label>
        Phone (optional, but highly recommended that you share):<br>
        <input type="tel" name="phone" style="width: 100%; padding: 0.5rem; margin-top: 0.5rem;" />
    </label><br><br>
    <button type="submit">Submit</button>
    </div>
  </form>

  <div class="end-message" id="endMsg">
    <p>Thanks for filling this out! I‚Äôll be waiting patiently at the cat council headquarters üêæ</p>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const answers = {};
  const questions = document.querySelectorAll('.question');
  let currentQuestionIndex = 0;

  function showNextQuestion() {
    if (currentQuestionIndex < questions.length - 1) {
      questions[currentQuestionIndex].classList.remove('active');
      currentQuestionIndex++;
      questions[currentQuestionIndex].classList.add('active');
    }
  }

    // Delay function
    function delay(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
    }

    // Show next question with delay
    async function showNextQuestionWithDelay() {
    await delay(600); // 600ms delay before transitioning
    showNextQuestion();
    }

  // ========== Popup Utility ==========

  function showPopup(message, buttons, callback) {
    const popup = document.createElement('div');
    popup.style.position = 'fixed';
    popup.style.top = '50%';
    popup.style.left = '50%';
    popup.style.width = '280px';
    popup.style.transform = 'translate(-50%, -50%)';
    popup.style.background = '#fffbe6';
    popup.style.padding = '2rem';
    popup.style.border = '3px solid #f9a825';
    popup.style.borderRadius = '12px';
    popup.style.boxShadow = '0 5px 15px rgba(0,0,0,0.3)';
    popup.style.zIndex = '9999';
    popup.innerHTML = `<p style="margin-bottom:1rem;">${message}</p>`;

    buttons.forEach(text => {
      const btn = document.createElement('button');
      btn.textContent = text;
      btn.style.margin = '0.5rem';
      btn.onclick = () => {
        document.body.removeChild(popup);
        document.body.classList.remove('popup-active');
        callback(text);
      };
      popup.appendChild(btn);
    });

    document.body.classList.add('popup-active');
    document.body.appendChild(popup);
  }

  function showPopupWithImage(message, options, callback, imageSrc) {
    const popup = document.createElement('div');
    popup.style.position = 'fixed';
    popup.style.top = '50%';
    popup.style.left = '50%';
    popup.style.width = '290px';
    popup.style.transform = 'translate(-50%, -50%)';
    popup.style.background = '#fff';
    popup.style.padding = '1rem';
    popup.style.border = '3px solid #f9a825';
    popup.style.borderRadius = '12px';
    popup.style.boxShadow = '0 5px 15px rgba(0,0,0,0.3)';
    popup.style.zIndex = '9999';
    popup.innerHTML = `<p style="margin-bottom:1rem;">${message}</p>`;

    if (imageSrc) {
      const img = document.createElement('img');
      img.src = imageSrc;
      img.className = 'popup-image';
      img.style.maxWidth = '100%';
      popup.appendChild(img);
    }

    options.forEach(text => {
      const btn = document.createElement('button');
      btn.textContent = text;
      btn.style.margin = '0.5rem';
      btn.onclick = () => {
        document.body.removeChild(popup);
        document.body.classList.remove('popup-active');
        callback(text);
      };
      popup.appendChild(btn);
    });

    document.body.classList.add('popup-active');
    document.body.appendChild(popup);
  }

  // ========== Cat Person Loop Popup ==========

  let catPersonPopupStage = 0;
  const catPersonPopupChain = [
    { msg: "Are you sure you don't want to hang out with a cat person?", options: ["Yes, wanna hangout", "No"] },
    { msg: "You‚Äôre really missing out. Have you seen us nap?", options: ["I'm reconsidering", "Still no"] },
    { msg: "Fine. No head boops for you. Want to rethink that?", options: ["I love head boops", "Nope"] },
    { msg: "Okay, what about Penguins? You like Penguins, right?", options: ["Penguins?! Yes!", "Meh"] },
    { msg: "Wow. You're hard to crack. Final offer: cat memes daily?", options: ["Okay fine, YES", "Never!"] },
    { msg: "We‚Äôre just gonna keep this going forever until you agree...", options: ["Alright already", "Keep going"] },
    { msg: "Alright, if you really wanna miss out on the opportunity then fine!", options: ["Make me happy", "Dil tod do mera"] },
    { msg: "Forgot to tell you it's loop XD. Dormamu, I've come to bargain!", options: ["Say Yes", "Stuck in loop forever"] }
  ];

  function runCatPersonPopupChain() {
    const popupStep = catPersonPopupChain[catPersonPopupStage % catPersonPopupChain.length];
    showPopup(popupStep.msg, popupStep.options, (res) => {
      const response = res.toLowerCase();
      if (response.includes("yes") || response.includes("okay") || response.includes("alright") || response.includes("love") || response.includes("penguins") || response.includes("say yes")) {
        catPersonPopupStage = 0;
        showNextQuestion();
      } else {
        catPersonPopupStage++;
        runCatPersonPopupChain();
      }
    });
  }

  // ========== Input Event Listeners ==========

  document.querySelectorAll('input[type="radio"]').forEach(input => {
    input.addEventListener('change', (e) => {
      const { name, value } = e.target;
      answers[name] = value;

      if (name === 'cats' && value === 'no') {
        showPopupWithImage("Really? I'm Reporting this to the Cat Council!", ["Report Yourself", "Go Back"], (res) => {
          if (res === 'Report Yourself') {
            window.open("https://youtu.be/ZN_XrB_St-8?si=OKPadVrfDFNl3XQE&t=24", '_blank');
          } else {
            document.querySelector('input[name="cats"][value="yes"]').checked = true;
          }
          showNextQuestionWithDelay();
        }, 'cat_council.png');
        return;
      }

    if (name === 'cat_person') {
        if (value === 'no') {
            catPersonPopupStage = 0;
            runCatPersonPopupChain();
            return;
        } else {
            // If she says yes, show q2a ‚Üí q2b ‚Üí q2c, then continue to q3
            showNextQuestionWithDelay();
            return;
        }
    }
      showNextQuestionWithDelay();
    });
  });

  // ========== Next Button and Final Submit ==========

  document.getElementById('monthNext').addEventListener('click', async () => {
    showNextQuestionWithDelay();
  });

  document.getElementById('dateForm')?.addEventListener('submit', function(e) {
  e.preventDefault();

  const formData = new FormData(e.target);

  // Collect all responses into `answers` object
  formData.forEach((value, key) => {
    answers[key] = value;
  });

  emailjs.send("service_mvvn9am", "template_ek8dj7v", answers)
    .then(function(response) {
      console.log("SUCCESS!", response.status, response.text);
      document.getElementById('dateForm').style.display = 'none';
      document.getElementById('endMsg').style.display = 'block';
    }, function(error) {
      console.error("FAILED...", error);
      alert("Oops! Something went wrong while sending.");
    });
});


});
</script>

</body>
</html>